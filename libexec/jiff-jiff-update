#!/usr/bin/env bash
# Usage: jiff jiff-update
# Summary: Update jiff

source stdlib

declare -r WorkingDir="${_JIFF_ROOT}"

# TODO: read deps from package.sh
main () {
  basher upgrade binaryphile/bash-libs
  basher upgrade binaryphile/jiff-core
  current="$(jiff context | tail -1 | cut -d " " -f3)"
  jiff context none
  git checkout -- .
  git fetch
  git reset --hard origin/master
  jiff context "${current}"
}

return 0 2>/dev/null || true
strict_mode on
run_in_directory "${WorkingDir}" "main" "${@}"
